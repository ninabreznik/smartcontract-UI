const ethers = require('ethers')
const decodeReturnData = require('decodeReturnData')

module.exports = getReturnData

function getReturnData (opts) {
  var iface = new ethers.utils.Interface(opts.solcMetadata.output.abi)
  var fun = opts.contract.interface.functions[opts.fnName]
  var txReturn
  var ifaceTypes

  if (opts.tag === 'input') {
    ifaceTypes =  fun.inputs
    var tx = { data: opts.data }
    txReturn = iface.parseTransaction(tx).args
  }
  else if (opts.tag === 'output') {
    ifaceTypes =  fun.outputs
    txReturn = opts.transaction
  }

  var decodedData = decodeReturnData(txReturn, ifaceTypes)
  return decodedData
}
